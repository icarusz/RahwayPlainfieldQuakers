<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.506">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andew Holz">

<title>PlainfieldRahwayQuakerMeeting - History</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">PlainfieldRahwayQuakerMeeting</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./resource-aboutquakerinsight.html"> 
<span class="menu-text">Quaker Insights</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./resource-aboutmeeting.html"> 
<span class="menu-text">About the Meeting</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.facebook.com/RahwayAndPlainfieldQuakerMeeting/"> <i class="bi bi-facebook" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">History</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Andew Holz </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>The Story of Friends in Plainfield Public ContentAnyone can view this post Posted by Tracy Djanie on 07/16/2017 - 11:39am</p>
<p>The Story of the Friends in Plainfield Including</p>
<p>A History of Early Quaker Families by William L. Dudley March 29, 1929 A faded typed carbon copy of the following history was found in the archives of the Rahway &amp; Plainfield Monthly Meeting of the Religious Society of Friends. In connection with the efforts surrounding a successful application for a NJ Historical Trust Grant to restore portions of the Meeting House exterior, a number of historical documents surfaced. The meeting authorized a committee to assemble and preserve this material, and this web page posting is one result of that effort. ©1998, Rahway &amp; Plainfield Monthly Meeting of the Religious Society of Friends Please address any questions, comments, or suggestions for correction to the Webmaster The story of the Friends in Plainfield . . .</p>
<pre><code>. . . is the story of the community itself for the first hundred years or more, for not only was Plainfield settled by the Friends, but theirs was the dominant influence from its first settlement at about the beginning of the Eighteenth Century until after the coming of the railroad, and the name which they gave to the street upon which their Meeting House is still located, that of Peace Street, lasted until about forty years ago (1889) when the name was changed to Watchung Avenue by a resolution of the City Council.
Why the Friends Came to Plainfield

Why the Friends came to Plainfield is a question which is easily answered, for they were the owners not only of Plainfield but of the entire State of New Jersey. From High Point at the northern end to Cape May at the southernmost tip and from the Atlantic Ocean to the Delaware River, the entire state had passed to the ownership of the Friends by purchase from Lord Berkeley and Sir George Carteret less than twenty years after these proprietors had received it as a gift from the Duke of York at the time the English took over the Dutch possessions in America.

West Jersey was bought by the Quakers of Pennsylvania in 1675 and East Jersey in 1682. The latter group was headed by William Penn himself, and the purchase price was œ3500, equal to about $17,000 in present (1929) currency. Of course this sum was proportionately very much greater in those days than now but even so, it was a purchase which would compare favorably with the celebrated sale of Manhattan Island for $24., for Penn's bargain included the whole of the present state with the exception of the extreme southern and western part.

The purpose of the Friends in buying New Jersey was the same as actuated them in the establishment of Pennsylvania, that is, to afford a refuge from the persecution to which they were subjected in England which became intense after the Duke of York succeeded to the throne with the title of James II in 1685. This led to a very extensive migration which resulted in the settlement of Plainfield and the adjacent territory. There was also a considerable influx of Scotch Covenanters, fleeing from similar persecution, and many settlers came from New York and New England.
What the Friends Found When they came to Plainfield

As is usually the case in a new country, the progress of settlement was along the water courses and the first settlers reached the site of Plainfield by way of the Raritan River, Bound Brook, Cedar Brook and Green Brook, ascending the latter as far as Scotch Plains, and their first farms were laid out on the level lands upon either side of these streams. The country was an unbroken wilderness, covered with a dense forest and traversed only by the trails of the Indians. All the possessions which the settlers brought with them, and these were numerous, as they were a well-to-do class of people generally, were transported in sailing vessels up the Raritan River and then carried in boats which were poled up the brooks against the current of the streams. Travel by land was possible only on foot or horseback along the Indian trails.

Payment was made to the Indians for all land taken and, as is well known, the friends never had any difficulties with the original inhabitants of the country, to whom they were known as the "People of Peace".

To the level lands upon which they located, the early settlers gave the name of "the Plains" and the little group of houses soon became known as "The Quaker Settlement on the Plains", the first mention of the name "Plainfield" not appearing until 1707. The Watchung Mountains were termed by them the "Blue Hills" and the highlands at Netherwood were called the "Short Hills".
The Friendly Families

Among the first families who bought land, cleared the forests and established homes here were many whose names are still prominent in the community, though not all of them are yet identified with the Friends. Chief among these were the Websters.
The Websters

The Webster Friends were of Scotch origin. William Webster, the founder, settled east of Plainfield about 1685. His descendants have always lived on adjacent territory. William Webster's oldest son was William Webster, Jr., born in 1692. He married Susannah Cowperthwaite and soon afterwards began housekeeping - about 1718-20 - not far from this spot, on a large farm through which Cedar Brook ran, and which probably extended to Green Brook. This pioneer's home was on the south side of the stream where Prospect Avenue now crosses. In this home, one of the earliest inland settlements, were eleven children born, and here the Webster homestead remained for generations.

The first child was John, born in 1718, who in 1743 married Anna Taylor, granddaughter of Richard Hartshorn of distinguished Quaker stock from Middletown. This family still owns the Highlands of the Navesink, near Sandy Hook. John and his younger brother, Hugh - who married Sarah Marsh in 1753 - were prominently instrumental in 1788 in locating the present Plainfield Meeting House on the three-acre lot where it stands today. The lot is part of the original Webster farm.

The Websters were mainly instrumental in opening in 1763, the roadway, which was known afterward as the road to Rahway, later as Peace Street and now as Watchung Avenue. It was they who built the first grist mill, on Green Brook, at the head of Peace Street. In 1782, Taylor Webster, a son of the builder, was granted by his father the privilege of constructing a race-way from the pond to the new mill on the mountain road, now Somerset Street. The Webster family may properly be credited with localizing the town of Plainfield.
The Vails

No family name is more honorably and continuously associated with the welfare of the Friends in this locality than that of the Vails. In 1687 mention is made of John Vail as an active member of the Society. His name is found first in the primitive annals of Salem, Mass. about 1650 and is discovered subsequently in Westchester County, N.Y., from whence he moved to East Jersey about 1685.

There were two prominent sons, John Vail, Jr., born in 1685, and Samuel Vail. John married in 1712, Martha Fitz Randolph of Woodbridge. The farm of John Vail extended from near present Richmond Street on both sides of Green Brook to the vicinity of Netherwood Avenue.

Samuel Vail, son of the original John, in 1725 married Sarah Farrington, of Westchester County, N.Y., where he lived and died. He was a Friend, and about the date of his marriage purchased a large plantation on Green Brook near present Dunnellen. This land was occupied by his two sons, John and Stephen. John Vail, oldest son of Samuel, married in 1730 Margaret Laing, daughter of John and Elizabeth Shotwell Laing. To each of his eight sons he gave a farm; four, John, David, Abraham and Joseph (a son by his second wife, Mary Laing) at Green Brook; and four, Daniel, Isaac, Jacob and Benjamin, in Passaic Valley, near Basking Ridge.

Stephen Vail, the other son of Samuel, in 1733 married Esther Smith. Their children were Thomas, Benjamin, Stephen, Abigail, Abraham and Sarah. Some of the Vails still live upon the original John Vail Tract.
The Fitz Randolphs

Nathaniel Fitz Randolph was the oldest son of the largest and most influential family in this part of the colony before the Revolution. The founder of these distinguished people in America was Edward Fitz Randolph, of England, who came to America in 1630. Nathaniel, eldest of ten children, was born at Barnstable, Mass., in 1642. He and his immediate descendants were the only members of this prominent family belonging to the Friends. It is thought Nathaniel joined the Society at his marriage in 1662. After removal to the neighborhood of Woodbridge, N.J., Nathaniel filled all the local and county offices. In 1704 his house was opened for weekly meetings of the Friends. He died in 1713. His descendants have married with the Hulls, the Kinseys, the Hartshorns, the Hamptons, the Marshes, the Vails, the Laings, the Websters, the Shotwells and the Smiths.
The Shotwells

Prominent in the early beginning of the society in this vicinity was Abraham Shotwell, who, though not himself a Quaker, was warmly in sympathy with the common people in their contentions with the Lords Proprietors' government about titles to land. Shotwell's independence resulted in the confiscation of his property in Elizabethtown. After his death two sons, Daniel and John, succeeded, under the Quaker management of 1683, in securing restoration to the family. John, in 1679, married Elizabeth Burton. For generations since descendants have lived in Union county. Marriage with the Thorns, Laings, Websters, Vails, Marshes, Pounds and other pioneer settlers has given the State some of its most useful and prominent citizens. At the opening of this century the names of eighty-six Shotwells are recorded in the Society.

The first mention of this locality as Plainfield is noticed in connection with the register of the birth of one of John Shotwell's grandchildren. His daughter Elizabeth, had married John Laing in 1705, and their daughter Elizabeth, the record states, was "born at Plainfield ye 11th of ye 10th month, 1707". Earlier reference to this place had been made as the "Quaker settlement on the Plains", to distinguish it from the small colony at Scotch Plains.

The first marriage in the present Plainfield Meeting House was that of Amy Shotwell to Charles Beooks.
The Laings

The Laing family composed a prominent part of the first permanent settlers in this neighborhood. John Laing, the progenitor of this long line in East Jersey, came over from Craigforth, Aberdeen County, Scotland, August 1685, landing in Amboy, near which place for a few years he lived with his wife Margaret and his children, John, Abraham, William, Christiana and Isabel. In 1698 he moved to "the Plains" near where South Plainfield now is. His son John married, in 1708, Elizabeth Shotwell, a direct descendent of the original Abraham Shotwell. His daughter Isabel, in 1700, married Joseph Fitz Randolph, son of Nathaniel. Both families were always active Friends. In 1725 weekday meetings were established at John Laing's. The location was so easy of access to Friends living along Green Brook, Cedar Brook and vicinity, that by 1731-36, a meeting house was built which was the beginning of the Plainfield Society.
The Marshes

The original ancestors of the Marsh family in the United States were three brothers, born in England, who came to America in the first half of the seventeenth century. John Marsh settled in Connecticut in 1639, George Marsh made a permanent settlement at Hingham, Mass., and Samuel Marsh after a short stay in New Haven colony moved to this section of New Jersey, where he became the owner of much land and the progenitor of most of those in Union County bearing his name.
Fields, Pounds and Thorns

Early representatives of these families came from Long Island. The Fields of Piscataway are descended from John Field, who came from Flushing about 1690-95, and settled on a large plantation along the Raritan River.

Joseph and Mary Thorn, of Flushing, L.I., had a son Jacob, born in 1700, who in 1723 married Susannah Shotwell and settled in Middlesex County, near here. Their descendants were mostly Friends.

The ancestor of the Pounds of New Jersey was John Pound, and early settler in Piscataway, whose son Elijah Pound, born in 1712, was a prominent and influential member of this meeting in its first history. With those of the Thorns the names of this family are among the oldest on the Friend's records.
Other Names

The Bloomfields were among the earliest settlers in Middlesex County. Ezekiel in 1680 married Hope Fitz Randolph, a sister of Nathaniel. His great-grandson, Joseph Bloomfield, was Attorney-General of New Jersey in 1785 and governor of the State from 1801-12.

The Dunhams of Quaker faith were of different ancestry than the Baptist family of that name who settled in Piscataway. The founder of the Dunham Friends was Jonathan Dunham, of Massachusetts, who settled in Woodbridge.

The Cowperthwaites descended from Hugh, of North England. He came to America in 1648 with his wife Elizabeth. About 1674 he settled at Flushing . His descendants married with the Plainfield Friends.
The Plainfield Meeting

The Plainfield Meeting of the Society of Friends had its beginning in a meeting established at Perth Amboy in 1686, which was the third in the state, earlier meetings having been established at Shrewsbury in 1670 and at Middletown in 1675.

No meeting house was built at Perth Amboy and in 1704 the meeting was moved to Woodbridge, where it met at the house of Nathaniel Fitz Randolph until 1714 when a meeting house was completed. The Plainfield Friends became members of this meeting and were faithful in their attendance until 1721 when they petitioned for leave to meet at the home of John Laing in Piscataway Township, near the present grounds of the Plainfield country Club.

The request was granted and the Plainfield Friends met at John Laing's house until his death in 1731, when he left them a plot of ground as a site for a meeting house, which was built in the same year and was known as the Plainfield Meeting House. It was 24 feet square and 14 feet "between joynts" which probably means between the sills and the plates.

This house was occupied until 1788 when the present meeting house on Watchung Avenue was built on a plot of three acres bought from John Webster. The cost of the land and the fencing of it was œ47 14s 3d, or about $235 (1929) of which possibly $200.00 was the cost of the land. The cost of the building was œ474 7s 10d, or about $2,300.00. Except for œ13 10s, which was obtained by the sale of the old meeting house and lot, the entire amount was raised by subscription, which was quite an undertaking in view of the fact that the entire population of the community was less than 200 persons.

This meeting house has been in continuous use since that time and in 1885 the Centennial of its building was observed with appropriate ceremonies at which time a history of the meeting was read by Margaret Fitz Randolph Vail, a descendant of two of the most prominent Friendly families already mentioned, and the Clerk of the City, Oliver B. Leonard, delivered an address on the "Early Friends of Plainfield", from both of which the facts in this paper have been largely derived. Another celebration was held on the 125th Anniversary in 1913.
The Present Title of the Plainfield Meeting

The business sessions of the local meetings of the Religious Society of Friends are held once a month and so are termed "Monthly Meetings". Also, it is the custom to include more than one local meeting in a single Monthly Meeting. For this reason, the Plainfield Meeting was joined with the Rahway Meeting many years ago with the title of "The Rahway and Plainfield Monthly Meeting of the Religious Society of Friends:, which title is still retained, although the Rahway Meeting passed out of existence some years ago.

Burying Grounds

The plot of land on the border of his farm which was left by John Laing to the Plainfield Meeting in 1731 was large enough to include a burying ground also and when the lot occupied by the first meeting house was re-sold to the Laing family in 1788, it would appear that the burying ground was retained as it was still in existence more than one hundred years later and at the celebration of the Centennial of the Meeting House in 1888, it was strongly urged that the old burying ground should be enclosed and suitably marked. This, however, was not done and the old burying ground appears since to have been ploughed over and obliterated, although its site probably could be determined by proper search. The present burying ground, as is well known, is situated in the rear of the Meeting House upon a part of the original plot</code></pre>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>